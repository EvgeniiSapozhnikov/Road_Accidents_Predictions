# Построение модели для определения риска попадания пользователя каршеринга в ДТП

__Цель исследования__ – В ходе работы необходимо определить на основании имеющихся данных, существует ли риск того, что пользователь каршеринга попадет в ДТП исходя из построенного маршрута, т.е. в ходе исследования решается задача __бинарной классификации__.

__Задачи:__
1. Подгрузить исходные данные.
2. Провести статистический анализ исходных данных.
3. Сформировать датасет для моделей машинного обучения, провести предобработку данных.
4. Выбрать целевую метрику и создать несколько моделей для оценки водительского риска.
5. Провести анализ важности факторов.
6. Сформулировать выводы по итогам выполненной работы.

___

## Статистический анализ факторов ДТП

1. В первые пять месяцев года происходит больше аварий, чем в остальные.
2. Основной причиной ДТП является нарушение правил дорожного движения.
3. Основной количество ДТП приходится на период с 10:00 до 23:00. 
4. Для утренних и ночных часов можно заметить рост числа уснувших за рулем.
5. Для дневных и вечерних часов можно заметитт рост числа водителей под воздействием лекарств.

___

## Предобработка данных

1. Выявлены и удалены явные дубликаты.
2. Обработаны либо удалены пропуски.
3. Обработаны выбросы.
4. Данные разбиты на обучающую, валидационную и тестовую выборки, произведено масштабирование и прямое кодирование признаков.

___

## Выбор метрики

Исходя требований заказчика, в ходе выполнения исследования будет решаться задача __бинарной классификации__.

При этом важно выявлять не только тех пользователей, кто потенциально может попасть в ДТП, но и минимизировать количество __ложноотрицательных ответов__. Можно было бы принять __полноту__, однако более информативной была бы метрика __ROC-AUC__.

___

## Обучение моделей

Для обучения возьмем следующие модели:
1. Случайный лес.
2. Градиентный бустинг (CatBoost).
3. Нейросеть.

Для подбора гиперпараметров применим библиотеку `optuna`.

___

## Обучение моделей и подбор гиперпараметров

1. Наибольшее значение метрики `ROC-AUC` получено при использовании модели "CatBoost".
2. По результатам тестирования модели получилось выявлять порядка 60% потенциальных нарушителей.

___

## Общие выводы

__Основной причиной ДТП является нарушений правил дорожного движения, среди которых наиболее часто встречается нарушение скоростного режима.__

Как следствие, на графике с типом столкновений встречается большое число ДТП, в которых один автомобиль въехал в другой сзади или сбоку.

__Таким образом, в качестве основной рекомендации следует обратить внимание те участки, где ДТП из-за превышения скоростного режима встречаются чаще (возможно, вести отдельный учет таких участков, либо сразу учитывать, что при движении на скоростных дорогах и магистралях риск таких ДТП в среднем выше). Кроме того, можно вести контроль манеры вождения пользователей и, если они часто превышают скорость, вносить их в категорию водителей, которые потенциально могут устроить ДТП на дороге.__